@* @model IEnumerable<CLDV6212_POE_ST10435542.Models.Order> *@
@model IEnumerable<CLDV6212_POE_ST10435542.Models.OrderViewModel>
@* i used the new model so that i can make use of the other properties (customer name, prodct name, availability status) *@
@* According to Rout (2025), since i created a new ViewModel, i would have to use that model instead of the original Order Model if i wanted to implement the extra properties in thsi Index View *@

@{
    ViewData["Title"] = "Index";
}

@* I made use of Razor View to generate this view and made minor tweaks to my liking *@

<p></p>
<h1>Order Management</h1>
<p></p>
<h4>Orders🚚</h4>
<hr />
<p></p>

@{
    @* by using ViewBag it made populating the list easier because ive defined a viewbag in the controller that links to the LastModified property and assigned the date ranges to it *@
    var selectedToday = ViewBag.SelectedOrderDate == "today" ? "selected" : "";
    var selectedWeek = ViewBag.SelectedOrderDate == "week" ? "selected" : "";
    var selectedMonth = ViewBag.SelectedOrderDate == "month" ? "selected" : "";
}

<form method="get" asp-action="Index">
    <div class="form-group">
        <label>Filter by Scheduled Date:</label>
        <select name="OrderDateFilter" class="form-control">
            <option value="">All</option>
@* According to StackOverflow (2016), this is the structure needed to display a ViewBag in a select list, as an option value *@
            <option value="today" selected="@(ViewBag.SelectedOrderDate == "today" ? "selected" : null)">Today</option>
            <option value="week" selected="@(ViewBag.SelectedOrderDate == "week" ? "selected" : null)">This Week</option>
            <option value="month" selected="@(ViewBag.SelectedOrderDate == "month" ? "selected" : null)">This Month</option>
        </select>
        <p></p>
        <button type="submit" class="btn btn-primary">Filter</button>
    </div>
</form>
<br />
<p>
    <a asp-action="AddOrder" class="btn btn-primary">Create New</a>
</p>

<table class="table table-hover">
    <thead>
        <tr class="table-active">
            <th>
                @Html.DisplayNameFor(model => model.OrderID):
            </th>
            <th>
                Placed:
            </th>
            <th>
                Customer:
            </th>
            <th>
                Product:
            </th>
            <th>
                Availability:
            </th>
            <th>
                Scheduled For:
            </th>
            <th>
                Order Status:
            </th>
            <th>
                Action:
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.OrderID)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Timestamp)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CustomerName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ProductName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.AvailabilityStatus)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.OrderDate)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.OrderStatus)
            </td>
            <td>
                @* <form asp-action="DeleteOrder" method="post" style="display:inline;"> *@
                @*     <input type="hidden" name="partitionKey" value="@item.PartitionKey" /> *@
                @*     <input type="hidden" name="rowKey" value="@item.RowKey" /> *@
                @*     <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this bird?');"> Delete </button> *@
                @* </form> *@
                <a asp-action="ViewOrder" asp-route-partitionKey="@item.PartitionKey" asp-route-rowKey="@item.RowKey" class="btn btn-outline-primary">Details</a>
            </td>
        </tr>
}
    </tbody>
</table>

@* References:

Pranaya Rout, 2025. Dot Net Tutorials. ViewModel in ASP.NET MVC. [online]
Available at:
<https: //dotnettutorials.net/lesson/view-model-asp-net-mvc />
[Accessed 21 August 2025].

StackOverflow, 2016. Populate Select using ViewBag without using html Helper. [online]
Available at: <https://stackoverflow.com/questions/39755802/populate-select-using-viewbag-without-using-html-helper> [Accessed 23 August 2025].

*@